import pandas as pd
import xml.etree.ElementTree as ET
import os

# --------------------------------------------
# Función para convertir cada archivo XML a su propio archivo CSV
# --------------------------------------------
def convertir_xml_a_csv():
    # Definir la ruta donde están los archivos XML
    ruta_xml = "C:/Users/Dariana/Downloads/FAERS"
    
    # Iterar sobre todos los archivos XML en la carpeta especificada
    for archivo in os.listdir(ruta_xml):
        if archivo.endswith(".xml"):  # Filtrar solo archivos .xml
            ruta_completa = os.path.join(ruta_xml, archivo)
            
            # Mensaje de archivo en proceso
            print(f"Procesando archivo: {archivo}")

            # Analizar el archivo XML
            tree = ET.parse(ruta_completa)
            root = tree.getroot()

            # Extraer la información útil del XML y convertirla en un DataFrame
            data = []
            for elem in root.findall('registro'):  # Ajusta según tu XML
                data.append({
                    'columna1': elem.find('columna1').text,
                    'columna2': elem.find('columna2').text
                    # Añadir más columnas según sea necesario
                })
            
            # Convertir datos extraídos a DataFrame
            df = pd.DataFrame(data)
            
            # Crear nombre de archivo CSV para cada XML procesado
            salida_csv = f"C:/Users/Dariana/Downloads/FAERS/{archivo.replace('.xml', '_data.csv')}"
            
            # Guardar el DataFrame como CSV
            df.to_csv(salida_csv, index=False)
            print(f"Archivo procesado y guardado como: {salida_csv}")

# Ejecutar el proceso
convertir_xml_a_csv()

